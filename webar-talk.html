<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VDC - Trợ lý ảo Intro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
</head>
<body class="bg-gray-100 p-4">

    <div class="max-w-md mx-auto bg-white rounded-xl shadow-lg overflow-hidden text-center">
        <div class="p-4 bg-blue-900 text-white">
            <h2 class="font-bold text-lg">TRUNG TÂM HUẤN LUYỆN VDC</h2>
            <p class="text-xs text-blue-200">Trợ lý ảo hỗ trợ học viên</p>
        </div>

        <div class="relative">
            <model-viewer 
                id="avatar-3d"
                src="https://modelviewer.dev/shared-assets/models/RobotExpressive.glb" 
                ar ar-modes="webxr scene-viewer quick-look" 
                camera-controls 
                shadow-intensity="1"
                animation-name="Idle" 
                class="w-full h-96 bg-gray-50">
            </model-viewer>

            <audio id="guide-voice" src="audio/gioi-thieu-vdc.mp3"></audio>

            <div class="absolute bottom-4 left-0 right-0 flex justify-center">
                <button onclick="toggleGuide()" id="btn-action" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-full shadow-lg flex items-center transition transform active:scale-95">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
                    Nghe Giới Thiệu
                </button>
            </div>
        </div>
    </div>

    <script>
        const model = document.querySelector("#avatar-3d");
        const audio = document.querySelector("#guide-voice");
        const btn = document.querySelector("#btn-action");
        let isPlaying = false;

        function toggleGuide() {
            if (!isPlaying) {
                // 1. Chạy âm thanh
                audio.play().catch(error => {
                    alert("Lỗi: Không tìm thấy file audio/gioi-thieu-vdc.mp3. Vui lòng kiểm tra lại thư mục.");
                });

                // 2. Chuyển động tác Robot: Vẫy tay (Wave) cho thân thiện
                // Nếu muốn nó nói liên tục, dùng 'Talk' (nếu file 3D có sẵn)
                model.animationName = 'Wave'; 
                
                // 3. Đổi nút thành "Dừng lại"
                btn.innerHTML = '<svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"></path></svg> Dừng lại';
                btn.classList.replace('bg-yellow-500', 'bg-red-500');
                
                isPlaying = true;

                // 4. Khi nói xong tự động dừng
                audio.onended = function() {
                    resetState();
                };
            } else {
                // Dừng chủ động
                audio.pause();
                audio.currentTime = 0;
                resetState();
            }
        }

        function resetState() {
            model.animationName = 'Idle'; // Quay về đứng yên
            btn.innerHTML = '<svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg> Nghe Giới Thiệu';
            btn.classList.replace('bg-red-500', 'bg-yellow-500');
            isPlaying = false;
        }
    </script>
</body>
</html>
