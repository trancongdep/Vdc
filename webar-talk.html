<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VDC - Trợ lý ảo 3D</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    
    <style>
        model-viewer { width: 100%; height: 500px; background-color: #f0f0f0; }
        .ar-btn {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: #2563eb; color: white; padding: 12px 24px; border-radius: 30px;
            font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            display: flex; align-items: center; gap: 8px;
        }
    </style>
</head>
<body class="bg-gray-100 p-4">

    <div class="max-w-md mx-auto bg-white rounded-xl shadow-lg overflow-hidden relative">
        <div class="p-4 border-b">
            <h2 class="font-bold text-blue-900 text-lg">Trợ lý ảo VDC</h2>
            <p class="text-sm text-gray-500">Bấm nút bên dưới để nghe hướng dẫn</p>
        </div>

        <model-viewer 
            id="avatar-3d"
            src="https://modelviewer.dev/shared-assets/models/RobotExpressive.glb" 
            ar ar-modes="webxr scene-viewer quick-look" 
            camera-controls 
            shadow-intensity="1"
            animation-name="Idle"> </model-viewer>

        <audio id="guide-voice" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>

        <button onclick="startPresentation()" class="ar-btn bg-blue-600 hover:bg-blue-700 transition">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            Bắt đầu Hướng dẫn
        </button>
    </div>

    <script>
        const model = document.querySelector("#avatar-3d");
        const audio = document.querySelector("#guide-voice");
        let isPlaying = false;

        function startPresentation() {
            if (!isPlaying) {
                // 1. Chuyển động tác: Ví dụ chuyển sang 'Wave' (Vẫy tay) hoặc 'Talk'
                // Lưu ý: Tên animation phải có sẵn trong file 3D
                model.animationName = 'Dance'; 
                
                // 2. Phát âm thanh
                audio.play();
                
                // 3. Xử lý khi nói xong
                audio.onended = function() {
                    model.animationName = 'Idle'; // Quay về đứng yên
                    isPlaying = false;
                };

                isPlaying = true;
            } else {
                // Bấm lần nữa để dừng
                audio.pause();
                audio.currentTime = 0;
                model.animationName = 'Idle';
                isPlaying = false;
            }
        }
    </script>
</body>
</html>
