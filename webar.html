<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VDC - Tương tác AR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    
    <style>
        model-viewer { width: 100%; height: 500px; background-color: #eee; }
        /* Điểm chạm (Hotspot) */
        .hotspot {
            display: block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: none;
            background-color: #ff0000; /* Màu đỏ gây chú ý */
            box-shadow: 0 0 10px rgba(255,0,0,0.5);
            animation: pulse 1.5s infinite;
            cursor: pointer;
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
    </style>
</head>
<body class="bg-gray-100 p-4">

    <div class="max-w-md mx-auto bg-white p-4 rounded-xl shadow-lg">
        <h2 class="text-xl font-bold text-blue-900 mb-2">Bài tập: Mở tủ điện & Kiểm tra CB</h2>
        <p class="text-sm mb-4">Hướng camera xuống sàn nhà. Bấm vào <span class="text-red-600 font-bold">nút đỏ</span> trên tủ để mở cửa.</p>

        <model-viewer 
            id="ar-model"
            src="https://modelviewer.dev/shared-assets/models/RobotExpressive.glb" 
            ar ar-modes="webxr scene-viewer quick-look" 
            camera-controls 
            shadow-intensity="1">

            <button class="hotspot" slot="hotspot-hand" 
                    data-position="-0.54 0.93 0.1" 
                    data-normal="-0.73 0.05 0.69"
                    onclick="playAction()">
            </button>
            
            <div class="absolute bottom-4 left-4 bg-white/80 p-2 rounded text-sm font-bold text-blue-800" id="status-text">
                Trạng thái: Cửa đang đóng
            </div>

        </model-viewer>
    </div>

    <script>
        const modelViewer = document.querySelector("#ar-model");
        const statusText = document.querySelector("#status-text");
        let isOpen = false;

        // Hàm xử lý khi bấm vào nút đỏ (Hotspot)
        function playAction() {
            if (!isOpen) {
                // Kịch bản Mở cửa
                // Trong file 3D Robot này, animation tên là 'Dance' (Tôi giả lập là Mở cửa)
                modelViewer.animationName = 'Dance'; 
                modelViewer.play(); 
                
                statusText.innerText = "Trạng thái: Cửa đang mở... (Nguy hiểm!)";
                statusText.classList.replace("text-blue-800", "text-red-600");
                isOpen = true;
            } else {
                // Kịch bản Đóng cửa
                modelViewer.pause(); 
                modelViewer.currentTime = 0; // Tua về đầu
                
                statusText.innerText = "Trạng thái: Cửa đã đóng (An toàn)";
                statusText.classList.replace("text-red-600", "text-blue-800");
                isOpen = false;
            }
        }
    </script>
</body>
</html>
